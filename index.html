<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Brains Welcome</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom Styles -->
    <style>
        /* Base styles */
        body {
            font-family: 'Inter', sans-serif;
            @apply bg-slate-100 text-slate-800 transition-colors duration-300;
        }
        
        /* --- Dark Mode Theme --- */
        .dark body { @apply bg-slate-900 text-slate-200; }
        .dark .themed-bg { @apply bg-slate-800; }
        .dark .themed-bg-secondary { @apply bg-slate-900/50; }
        .dark .themed-text-primary { @apply text-slate-100; }
        .dark .themed-text-secondary { @apply text-slate-300; }
        .dark .themed-text-muted { @apply text-slate-400; }
        .dark .themed-shadow-sm { box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.3); }
        .dark .themed-shadow-md { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -2px rgba(0, 0, 0, 0.3); }
        .dark .themed-border { @apply border-slate-700; }
        .dark .themed-bg-input { @apply bg-slate-700 text-white placeholder-slate-400; }
        .dark .themed-bg-button { @apply bg-slate-700; }
        .dark .themed-bg-button-hover:hover { @apply bg-slate-600; }
        .dark #modal-overlay { background-color: rgba(0, 0, 0, 0.75); }
        .dark .badge-blue { @apply bg-blue-900/60 text-blue-200; }
        .dark .badge-green { @apply bg-green-900/60 text-green-200; }
        .dark .badge-purple { @apply bg-purple-900/60 text-purple-200; }

        /* --- Accessibility --- */
        :focus-visible {
            @apply outline-offset-2 rounded-md outline-2 outline-blue-500;
        }
        
        /* --- Animations --- */
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes popIn {
            0% { opacity: 0; transform: scale(0.8); }
            80% { opacity: 1; transform: scale(1.05); }
            100% { opacity: 1; transform: scale(1); }
        }

        #info-modal-container.hidden { @apply pointer-events-none; }
        #info-modal-container, #modal-overlay { transition: opacity 0.3s ease-in-out; }
        #info-modal-container.hidden #modal-overlay { @apply opacity-0; }
        
        #info-modal {
            animation: popIn 0.4s ease-out forwards;
        }

        .resource-card {
            transform-style: preserve-3d;
            transition: transform 0.5s, box-shadow 0.3s;
            animation: slideInUp 0.5s ease-out forwards;
            opacity: 0; /* Start hidden for animation */
        }
        .resource-card:hover {
            transform: perspective(1000px) rotateY(5deg) scale(1.05);
            @apply shadow-2xl;
        }
        
        @media (prefers-reduced-motion: reduce) {
            * { transition: none !important; animation: none !important; }
        }
        
        /* --- Layout --- */
        .filter-sidebar {
            position: sticky;
            top: 6rem;
            height: calc(100vh - 8rem);
            overflow-y: auto;
        }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header -->
    <header class="themed-bg themed-shadow-sm sticky top-0 z-20">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a href="#" class="flex items-center space-x-2">
                    <svg class="h-8 w-8 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>
                    <span class="text-xl font-bold themed-text-primary hidden sm:inline">All Brains Welcome</span>
                </a>
                <div class="flex items-center space-x-2 sm:space-x-4">
                    <div class="relative"><input type="search" id="search-bar" placeholder="Search..." class="w-36 sm:w-64 pl-10 pr-4 py-2 themed-border themed-bg-input rounded-full text-sm focus:ring-blue-500 focus:border-blue-500"><div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><svg class="h-5 w-5 themed-text-muted" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div></div>
                    <button id="theme-toggle" type="button" class="p-2 rounded-full themed-text-muted themed-bg-button-hover"><svg id="theme-toggle-dark-icon" class="h-5 w-5 hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg><svg id="theme-toggle-light-icon" class="h-5 w-5 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" /></svg></button>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Description Section -->
    <section class="themed-bg-secondary themed-border border-b">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8"><h1 class="text-2xl font-bold themed-text-primary mb-2 text-center">Neurodiversity & Assistive Technology Resource Hub</h1><p class="text-center themed-text-secondary max-w-4xl mx-auto">Welcome! This hub helps you discover tools and strategies for neurodiversity. Use the filters to find resources for organization, focus, communication, and more. Click any card to learn more.</p></div>
    </section>

    <!-- Main Content -->
    <main class="container mx-auto p-4 sm:p-6 lg:p-8">
        <div class="lg:grid lg:grid-cols-4 lg:gap-8">
            <aside class="lg:col-span-1 mb-8 lg:mb-0"><div class="filter-sidebar"><div class="p-6 rounded-lg themed-shadow-md" id="filters-container"><h2 class="text-xl font-semibold mb-4 themed-text-primary">Filters</h2><form id="filter-form"></form></div></div></aside>
            <section class="lg:col-span-3"><div class="themed-bg p-4 rounded-lg themed-shadow-sm mb-4 flex items-center justify-between"><h2 id="results-count" class="text-lg font-medium themed-text-secondary">Loading...</h2></div><div id="results-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div><div id="no-results" class="hidden text-center py-16"><svg class="mx-auto h-12 w-12 themed-text-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z" /></svg><h3 class="mt-2 text-lg font-medium themed-text-primary">No Results Found</h3><p class="mt-1 text-sm themed-text-muted">Try adjusting your search or filters.</p></div><div id="loading-indicator" class="text-center py-16"><svg class="animate-spin mx-auto h-8 w-8 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><p class="mt-2 themed-text-muted">Loading data...</p></div></section>
        </div>
    </main>

    <!-- Details Modal -->
    <div id="info-modal-container" class="fixed inset-0 z-40 hidden"><div id="modal-overlay" class="absolute inset-0 bg-gray-900 bg-opacity-75"></div><div class="relative flex items-center justify-center min-h-screen p-4"><div id="info-modal" class="themed-bg rounded-lg shadow-xl w-full max-w-2xl"><div class="p-6 sm:p-8"><div class="flex items-start justify-between"><h3 id="modal-title" class="text-2xl font-bold themed-text-primary"></h3><button id="modal-close-button" type="button" class="p-1 rounded-full themed-text-muted themed-bg-button-hover"><span class="sr-only">Close</span><svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg></button></div><div id="modal-content" class="mt-4 space-y-4"></div></div></div></div></div>
    
    <!-- Link Status Notification -->
    <div id="link-notification" class="fixed bottom-5 right-5 bg-slate-800 text-white py-3 px-5 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-500 z-50"><p></p></div>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        let database = [], activeFilters = { 'Areas of support': [], 'Format': [], 'Price': [] }, searchQuery = '';
        const resultsGrid = document.getElementById('results-grid'), resultsCount = document.getElementById('results-count'), noResults = document.getElementById('no-results'), loadingIndicator = document.getElementById('loading-indicator'), filterForm = document.getElementById('filter-form'), searchBar = document.getElementById('search-bar'), modalContainer = document.getElementById('info-modal-container'), modalTitle = document.getElementById('modal-title'), modalContent = document.getElementById('modal-content'), modalCloseButton = document.getElementById('modal-close-button'), modalOverlay = document.getElementById('modal-overlay'), themeToggle = document.getElementById('theme-toggle'), linkNotification = document.getElementById('link-notification'), filtersContainer = document.getElementById('filters-container');

        // Color palettes for cards and filters
        const cardColors = { light: ['bg-white', 'bg-sky-50', 'bg-teal-50', 'bg-rose-50', 'bg-amber-50'], dark: ['bg-slate-800', 'bg-sky-900/40', 'bg-teal-900/40', 'bg-rose-900/40', 'bg-amber-900/40'] };
        const filterColors = { light: 'bg-indigo-50', dark: 'bg-indigo-900/20' };

        const setupTheme = () => {
            const darkIcon = document.getElementById('theme-toggle-dark-icon'), lightIcon = document.getElementById('theme-toggle-light-icon');
            const applyTheme = (isDark) => {
                document.documentElement.classList.toggle('dark', isDark);
                darkIcon.classList.toggle('hidden', !isDark);
                lightIcon.classList.toggle('hidden', isDark);
                filtersContainer.classList.remove(isDark ? filterColors.light : filterColors.dark);
                filtersContainer.classList.add(isDark ? filterColors.dark : filterColors.light);
            };
            const isDark = localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            applyTheme(isDark);
            themeToggle.addEventListener('click', () => {
                const newTheme = !document.documentElement.classList.contains('dark');
                localStorage.setItem('theme', newTheme ? 'dark' : 'light');
                applyTheme(newTheme);
                renderResults(); // Re-render to apply new card colors
            });
        };

        const createFilters = () => {
            const filterGroups = { 'Areas of support': { items: [ 'Concentration and Focus', 'Organisation and Time management', 'Impulsivity and Hyperactivity', 'Processing and Memory', 'Communication and Social interaction', 'Routine, Structure, and Change', 'Movement and Co-ordination', 'Writing', 'Reading', 'Numbers and Mathematics', 'Auditory processing', 'Visual processing', 'Sensory sensitivity', 'Self-regulation, Managing Emotions, Confidence, and Self-esteem' ], limit: 4 }, 'Format': { items: [ 'Website', 'App', 'Hybrid system', 'Equipment', 'Software', 'Browser Extension', 'Feature' ], limit: 4 }, 'Price': { items: [ 'Free', 'Paid', 'Free with Paid options' ], limit: null } };
            let formHTML = '';
            for (const groupName in filterGroups) {
                const { items, limit } = filterGroups[groupName];
                items.sort();
                formHTML += `<div class="mb-6"><h3 class="font-semibold mb-3 themed-text-primary">${groupName}</h3><div class="space-y-2">`;
                items.forEach((item, index) => {
                    formHTML += `<label class="flex items-center space-x-3 cursor-pointer ${limit && index >= limit ? 'hidden' : ''}" data-filter-item><input type="checkbox" value="${item}" data-group="${groupName}" class="h-4 w-4 rounded themed-border bg-transparent text-blue-600 focus:ring-blue-500"><span class="text-sm themed-text-secondary">${item}</span></label>`;
                });
                formHTML += `</div>${limit && items.length > limit ? `<button type="button" data-action="toggle-filters" class="text-sm text-blue-500 hover:underline mt-2">Show all ${items.length}</button>` : ''}</div>`;
            }
            formHTML += `<button type="reset" id="reset-filters" class="w-full px-4 py-2 themed-bg-button themed-text-secondary font-medium rounded-md themed-bg-button-hover transition-colors">Reset Filters</button>`;
            filterForm.innerHTML = formHTML;
        };
        
        const renderResults = () => {
            const isDark = document.documentElement.classList.contains('dark');
            const currentCardColors = isDark ? cardColors.dark : cardColors.light;
            const anyFilterActive = Object.values(activeFilters).some(arr => arr.length > 0);
            const query = searchQuery.toLowerCase();
            const filteredData = database.filter(item => {
                const searchMatch = query === '' || item.Name.toLowerCase().includes(query) || item.Summary.toLowerCase().includes(query);
                const areaMatch = activeFilters['Areas of support'].length === 0 || (Array.isArray(item['Areas of support']) && activeFilters['Areas of support'].every(value => item['Areas of support'].includes(value)));
                const formatMatch = activeFilters['Format'].length === 0 || (Array.isArray(item['Format']) && activeFilters['Format'].every(value => item['Format'].includes(value)));
                const priceMatch = activeFilters['Price'].length === 0 || (Array.isArray(item['Price']) && activeFilters['Price'].some(value => item['Price'].includes(value)));
                return searchMatch && areaMatch && formatMatch && priceMatch;
            });

            resultsGrid.innerHTML = '';
            resultsCount.textContent = `${filteredData.length} Result${filteredData.length !== 1 ? 's' : ''}`;
            noResults.classList.toggle('hidden', filteredData.length > 0);

            filteredData.forEach((item, index) => {
                const card = document.createElement('div');
                const colorClass = currentCardColors[index % currentCardColors.length];
                card.className = `resource-card rounded-lg themed-shadow-md flex flex-col cursor-pointer ${colorClass}`;
                card.style.animationDelay = `${index * 50}ms`;
                const createBadge = (text, type) => `<span class="inline-block badge-${type} text-xs font-medium mr-2 mb-2 px-2.5 py-0.5 rounded-full">${text}</span>`;
                card.innerHTML = `<div class="p-6 flex-grow"><h3 class="text-xl font-bold themed-text-primary mb-2">${item.Name}</h3><p class="themed-text-secondary line-clamp-2 mb-4">${item.Summary}</p></div><div class="p-6 pt-0"><div>${item['Areas of support'].slice(0, 3).map(area => createBadge(area, 'blue')).join('')}${item.Format.map(format => createBadge(format, 'green')).join('')}${item.Price.map(price => createBadge(price, 'purple')).join('')}</div></div>`;
                card.addEventListener('click', () => showModal(item));
                resultsGrid.appendChild(card);
            });
        };

        const showModal = (item) => {
            modalTitle.textContent = item.Name;
            const detailSection = (title, content) => {
                if (!content || (Array.isArray(content) && content.length === 0)) return '';
                const contentHtml = Array.isArray(content) ? content.map(c => `<li class="py-1">${c}</li>`).join('') : `<p class="whitespace-pre-wrap">${content}</p>`;
                return `<div><h4 class="font-semibold themed-text-primary">${title}</h4><div class="themed-text-secondary mt-1 ${Array.isArray(content) ? 'list-disc list-inside' : ''}">${contentHtml}</div></div>`;
            };
            modalContent.innerHTML = `${detailSection('Summary', item.Summary)}${detailSection('Further info / notes', item['Further info / notes'])}<button data-link="${item.Link}" class="link-checker-button inline-block mt-4 px-5 py-2.5 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors focus:ring-4 focus:ring-blue-300">Visit Website</button>`;
            modalContainer.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        };
        
        const hideModal = () => {
            modalContainer.classList.add('hidden');
            document.body.style.overflow = '';
        };
        
        const showNotification = (message, duration = 3000) => {
            linkNotification.querySelector('p').textContent = message;
            linkNotification.classList.remove('opacity-0', 'translate-y-20');
            setTimeout(() => linkNotification.classList.add('opacity-0', 'translate-y-20'), duration);
        };

        const checkLink = async (url) => {
            showNotification('Checking link...', 2000);
            try {
                await fetch(url, { mode: 'no-cors' });
                showNotification('Link seems active! Redirecting...', 2000);
            } catch (error) {
                showNotification('Could not verify link. Proceed with caution.', 3000);
            }
            setTimeout(() => window.open(url, '_blank', 'noopener,noreferrer'), 500);
        };

        const initializeApp = async () => {
            try {
                const response = await fetch('database.json');
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                database = await response.json();
                createFilters();
                renderResults();
            } catch (error) {
                console.error("Failed to initialize:", error);
                resultsGrid.innerHTML = `<p class="text-red-500">An error occurred while loading data.</p>`;
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        };

        setupTheme();
        initializeApp();

        filterForm.addEventListener('input', e => {
            if (e.target.type === 'checkbox') {
                const { group, value } = e.target.dataset;
                if (e.target.checked) {
                    if (!activeFilters[group].includes(e.target.value)) activeFilters[group].push(e.target.value);
                } else {
                    activeFilters[group] = activeFilters[group].filter(item => item !== e.target.value);
                }
                renderResults();
            }
        });

        filterForm.addEventListener('click', e => {
            if (e.target.dataset.action === 'toggle-filters') {
                const container = e.target.previousElementSibling;
                const isShowingAll = e.target.textContent.startsWith('Show less');
                e.target.textContent = isShowingAll ? `Show all ${container.children.length}` : 'Show less';
                container.querySelectorAll('label[data-filter-item]:nth-child(n+5)').forEach(item => item.classList.toggle('hidden'));
            }
        });

        filterForm.addEventListener('reset', () => {
            activeFilters = { 'Areas of support': [], 'Format': [], 'Price': [] };
            searchQuery = '';
            searchBar.value = '';
            renderResults();
        });
        
        let searchTimeout;
        searchBar.addEventListener('input', () => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                searchQuery = searchBar.value;
                renderResults();
            }, 300);
        });

        modalCloseButton.addEventListener('click', hideModal);
        modalOverlay.addEventListener('click', hideModal);
        document.addEventListener('keydown', e => e.key === 'Escape' && !modalContainer.classList.contains('hidden') && hideModal());
        modalContainer.addEventListener('click', e => e.target.classList.contains('link-checker-button') && checkLink(e.target.dataset.link));
    });
    </script>
</body>
</html>
